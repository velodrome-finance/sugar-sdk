# ⛓ Chain


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

## Chain implementation

------------------------------------------------------------------------

<a
href="https://github.com/velodrome-finance/sugar-sdk/blob/main/sugar/chains.py#L32"
target="_blank" style="float:right; font-size:smaller">source</a>

### Chain

>  Chain (settings:sugar.config.ChainSettings)

*Initialize self. See help(type(self)) for accurate signature.*

------------------------------------------------------------------------

<a
href="https://github.com/velodrome-finance/sugar-sdk/blob/main/sugar/chains.py#L25"
target="_blank" style="float:right; font-size:smaller">source</a>

### require_context

>  require_context (f:Callable[...,~T])

### Get tokens

------------------------------------------------------------------------

### get_all_tokens

>  get_all_tokens (listed_only:bool=True)

### Get pools

------------------------------------------------------------------------

### get_pools

>  get_pools ()

### Get prices

------------------------------------------------------------------------

### get_prices

>  get_prices (tokens:List[sugar.token.Token])

*Get prices for tokens in target stable token*

### Sign and send transaction

------------------------------------------------------------------------

### sign_and_send_tx

>  sign_and_send_tx (tx, wait:bool=True)

### Set and check token allowance

------------------------------------------------------------------------

### check_token_allowance

>  check_token_allowance (token:sugar.token.Token, addr:str)

------------------------------------------------------------------------

### set_token_allowance

>  set_token_allowance (token:sugar.token.Token, addr:str, amount:int)

### Deposit

------------------------------------------------------------------------

### deposit

>  deposit (deposit:sugar.deposit.Deposit, delay_in_minutes:float=30,
>               slippage:float=0.01)

## OP Chain

------------------------------------------------------------------------

<a
href="https://github.com/velodrome-finance/sugar-sdk/blob/main/sugar/chains.py#L203"
target="_blank" style="float:right; font-size:smaller">source</a>

### OPChain

>  OPChain (**kwargs)

*Initialize self. See help(type(self)) for accurate signature.*

## Base Chain

------------------------------------------------------------------------

<a
href="https://github.com/velodrome-finance/sugar-sdk/blob/main/sugar/chains.py#L211"
target="_blank" style="float:right; font-size:smaller">source</a>

### BaseChain

>  BaseChain (**kwargs)

*Initialize self. See help(type(self)) for accurate signature.*

## Tests

Run tests using mainnets for reads and simnet for writes

``` python
# from sugar.chains import OPChain

# async with OPChain(rpc_uri="http://127.0.0.1:4444", pagination_limit=1) as chain:
#     print(chain.settings)
#     velo = [t for t in await chain.get_all_tokens() if t.symbol == 'VELO']
#     print(await chain.get_prices(velo))

# from sugar.chains import OPChain, BaseChain
# from sugar.deposit import Deposit

# from dotenv import load_dotenv
# from fastcore.test import test_ne
# import os

# load_dotenv()

# test_ne(os.getenv("SUGAR_PK"), None)

# test connection to localhost:4444

import socket
import sys


host, port ='localhost', 4444
try:
    # Create socket object
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    # Set timeout to 2 seconds
    sock.settimeout(2)
    
    # Attempt connection
    result = sock.connect_ex((host, port))
    if result == 0:
        print(f"✅ Successfully connected to {host}:{port}")
    else:
        print(f"❌ Could not connect to {host}:{port}")
        print(f"Error code: {result}")
    
except socket.error as err:
    print(f"❌ Connection failed: {err}")
finally:
    sock.close()

# async with OPChain() as chain:
#     pools = await chain.get_pools()
#     pools = list(filter(lambda x: x.token0 and x.token0.token_address == chain.usdc and x.token1.token_address == chain.velo, pools))
#     async with OPChain(rpc_uri="http://127.0.0.1:4444" ) as supersim:
#         print(supersim.settings)
#         # 0.02 USDC 
#         await supersim.deposit(Deposit(pools[0], 0.02))

# async with BaseChain() as chain:
#     pools = await chain.get_pools()
#     pools = list(filter(lambda x: x.token0 and x.token0.token_address == chain.usdc and x.token1.token_address == chain.aero, pools))
#     async with BaseChain(rpc_uri="http://127.0.0.1:4445" ) as supersim:
#         print(supersim.settings)
#         # 0.02 USDC 
#         await supersim.deposit(Deposit(pools[0], 0.01), slippage=0.05)
#         print("Done")
```

    ❌ Could not connect to localhost:4444
    Error code: 111
